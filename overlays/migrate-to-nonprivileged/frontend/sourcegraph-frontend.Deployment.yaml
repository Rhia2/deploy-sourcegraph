apiVersion: apps/v1
kind: Deployment
metadata:
  name: sourcegraph-frontend
spec:
  template:
    spec:
      initContainers:
        - name: transfer-cache
          image: index.docker.io/sourcegraph/alpine-3.12:insiders@sha256:c60832606950181f8f981360226ec4a179c4161b1de12cee4d7c930f6df2f6bb
          command: ["sh", "-c", "if [[ \"$(stat -c '%u' /mnt/cache)\" -ne 100 ]]; then chown -R 100:101 /mnt/cache; fi"]
          volumeMounts:
          - mountPath: /mnt/cache
            name: cache-ssd
          securityContext:
            runAsUser: 0
        - name: migrator
